<div class="flex flex-col h-full"
     role="dialog"
     aria-modal="true"
     aria-labelledby="cart-popup-header">
  <!-- Fixed Header -->
  <div class="flex-shrink-0 relative">
    <div class="px-20">
      <div class="flex justify-between items-center pt-8 pb-6">
        <!-- Title and Count -->
        <div class="flex items-center gap-3">
          <h2 id="cart-popup-header" class="text-xl font-semibold">
            <%= t("cart.title", default: "Shopping Cart") %>
          </h2>
          <span id="cart-popup-header-count" class="text-gray-500 font-medium">
            <%= header_count_text %>
          </span>
        </div>
        <!-- Clear Cart -->
        <% unless empty_cart? %>
          <div class="flex items-center gap-2">
            <%= button_to clear_all_cart_items_path,
                          method: :delete,
                          remote: true,
                          confirm: t("cart.confirm_clear", default: "Remove all items from your cart?"),
                          class: "p-2 text-text-primary hover:text-interactive-primary transition-colors border-none bg-transparent cursor-pointer",
                          aria: { label: t("cart.clear_all", default: "Clear all items") } do %>
              <%= render UI::IconComponent.new(name: :trash, css_class: "w-6 h-6") %>
            <% end %>
            <div class="w-px h-6 bg-gray-300"></div>
          </div>
        <% end %>
      </div>
    </div>
    <!-- Close button -->
    <button type="button"
            class="absolute top-8 right-6 p-2 text-text-primary hover:text-interactive-primary transition-colors"
            data-action="click->cart-popup#close"
      aria-label="<%= t("cart.close", default: "Close cart") %>">
      <%= render UI::IconComponent.new(name: :close, css_class: "w-6 h-6") %>
    </button>
  </div>
  <!-- Scrollable Content -->
  <div class="flex-1 overflow-y-auto overflow-x-hidden">
    <div id="cart-popup-content">
      <% if empty_cart? %>
        <%= render "cart/empty_state" %>
      <% else %>
        <%= render "cart/cart_items", cart_items: cart_items %>
      <% end %>
    </div>
  </div>
  <!-- Fixed Footer -->
  <% unless empty_cart? %>
    <div id="cart-popup-footer" class="flex-shrink-0">
      <%= render "cart/cart_footer", total_price: formatted_total_price %>
    </div>
  <% end %>
</div>
