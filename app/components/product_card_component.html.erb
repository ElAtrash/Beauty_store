<%= link_to product_url, class: "block group", data: { turbo_frame: "_top" } do %>
  <div class="product-card"
       data-product-id="<%= id %>"
       data-product-slug="<%= slug %>">
    <div class="relative aspect-square overflow-hidden">
      <%= image_tag image_url,
          alt: name,
          class: image_classes,
          loading: "lazy" %>
      <!-- Image Overlays -->
      <div class="absolute inset-0 pointer-events-none">
        <div class="flex justify-between items-start">
          <% if show_badges? %>
            <div class="flex flex-col gap-1 p-2">
              <% badges.each do |badge| %>
                <span class="<%= badge[:classes] %>">
                  <%= badge[:text] %>
                </span>
              <% end %>
            </div>
            <% else %>
            <div></div>
          <% end %>
           <!-- Wishlist Button -->
          <button class="product-wishlist-button pointer-events-auto p-2"
                  data="<%= wishlist_data.transform_keys { |key| key.to_s.dasherize } %>"
                  aria-label="Add to wishlist">
            <%= render UI::IconComponent.new(name: :heart, css_class: "w-5 h-5") %>
          </button>
        </div>
      </div>
    </div>
    <div class="pt-4 text-right space-y-3">
      <!-- Product Info Text -->
      <div class="space-y-1">
        <% if subtitle.present? %>
          <p class="text-sm font-medium text-muted transition-colors duration-200">
            <%= subtitle %>
          </p>
        <% end %>
        <h3 class="line-clamp-2 pt-2 leading-tight transition-colors duration-200">
          <%= name %>
        </h3>
      </div>
      <!-- Rating and Reviews -->
      <% if reviews_count > 0 %>
        <div class="flex justify-end">
          <%= render UI::RatingComponent.new(product: product, style: :compact) %>
        </div>
      <% end %>
      <!-- Price -->
      <div class="flex items-center gap-2 justify-end">
        <span class="<%= price_classes %>">
          <%= price_display %>
        </span>
        <% if original_price_display %>
          <span class="text-sm text-muted line-through transition-colors duration-200">
            <%= original_price_display %>
          </span>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
