<section class="product-grid-section pt-2 pb-6 md:pt-4 md:pb-8 bg-white"
         data-controller="product-grid"
         data-product-grid-pagy-url-value="<%= brand_path(brand) %>">
  <div class="container mx-auto px-4">

    <% if products? %>
      <div class="products-grid"
           data-product-grid-target="container"
           id="products-container">
        <%= render ProductCardComponent.with_collection(products) do |component| %>
          <div data-product-grid-target="product">
            <%= component %>
          </div>
        <% end %>
      </div>

      <% if more_products? %>
        <div class="text-center mt-8 md:mt-12">
          <%= render "shared/show_more_button", next_page: next_page %>
        </div>
      <% end %>

      <div class="hidden text-center mt-8" data-product-grid-target="loading">
        <div class="inline-flex items-center px-6 py-3 text-muted">
          <%= render IconComponent.new(name: :loading, class: "animate-spin -ml-1 mr-3 h-5 w-5 text-muted") %>
          Loading more products...
        </div>
      </div>
    <% else %>
      <div class="text-center py-16">
        <div class="max-w-md mx-auto">
          <%= render IconComponent.new(name: :shopping_cart, class: "w-16 h-16 text-disabled mx-auto mb-4") %>
          <h3 class="text-xl font-semibold mb-2">
            No products found
          </h3>
          <p class="text-muted mb-8">
            <%= brand.name %> products are coming soon. Check back later for new arrivals.
          </p>
          <%= link_to "Browse All Brands",
              brands_path,
              class: "btn-secondary" %>
        </div>
      </div>
    <% end %>
  </div>
</section>
