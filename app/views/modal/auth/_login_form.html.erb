<!-- Sign In/Up State -->
<div data-controller="auth-tab auth-form-coordinator"
     data-auth-tab-active-tab-value="signin"
     data-auth-tab-hidden-class="hidden"
     data-auth-tab-active-class="active">
  <!-- Notifications Area -->
  <div class="relative mb-6">
    <!-- Flash Messages -->
    <div class="space-y-2">
      <% if flash[:alert] %>
        <div class="p-3 bg-red-50 border border-red-200 rounded-md">
          <p class="text-sm text-red-600"><%= flash[:alert] %></p>
        </div>
      <% end %>
      <% if flash[:notice] %>
        <div class="p-3 bg-green-50 border border-green-200 rounded-md">
          <p class="text-sm text-green-600"><%= flash[:notice] %></p>
        </div>
      <% end %>
    </div>
    <!-- Turbo Frame for handling auth responses -->
    <turbo-frame id="auth_result"></turbo-frame>
  </div>
  <!-- Toggle Buttons -->
  <div class="flex bg-gray-100 p-1 rounded-lg mb-6">
    <button class="auth-tab-button signin-tab flex-1 py-2 px-3 text-sm font-medium rounded-md transition-colors"
            data-auth-tab-target="tabButton"
            data-action="click->auth-tab#switchTab keydown->auth-tab#handleKeydown"
            data-tab="signin"
            id="signin-tab">
      <%= t('auth.sign_in') %>
    </button>
    <button class="auth-tab-button signup-tab flex-1 py-2 px-3 text-sm font-medium rounded-md transition-colors"
            data-auth-tab-target="tabButton"
            data-action="click->auth-tab#switchTab keydown->auth-tab#handleKeydown"
            data-tab="signup"
            id="signup-tab">
      <%= t('auth.sign_up') %>
    </button>
  </div>
  <!-- Sign In Form -->
  <div class="auth-form-container"
       data-form="signin"
       data-auth-tab-target="signinForm">
    <%= form_with url: session_path,
        local: false,
        html: { novalidate: true },
        class: "space-y-4",
        data: {
          controller: "form-validation",
          turbo_frame: "auth_result",
          form_validation_translations_value: t('javascript.auth_form').to_json
        } do |form| %>
      <%= render FormFieldComponent.new(
        form: form,
        field: :email_address,
        type: :email,
        required: true,
        placeholder: t('auth.email_placeholder'),
        validation_rules: "email",
        options: { autofocus: true, autocomplete: "username" }
      ) %>
      <%= render FormFieldComponent.new(
        form: form,
        field: :password,
        type: :password,
        required: true,
        placeholder: t('auth.password_placeholder'),
        validation_rules: "password",
        options: { autocomplete: "current-password" }
      ) %>
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <input id="remember_me" name="remember_me" type="checkbox"
                 class="h-4 w-4 text-interactive focus:ring-interactive border-gray-300 rounded">
          <label for="remember_me" class="ml-2 block text-sm text-gray-700">
            <%= t('auth.remember_me') %>
          </label>
        </div>
        <%= link_to new_password_path, class: "text-sm text-primary hover:text-interactive-primary" do %>
          <%= t('auth.forgot_password') %>
        <% end %>
      </div>
      <%= form.submit t('auth.sign_in'), class: "btn-interactive btn-full btn-lg" %>
    <% end %>
  </div>
  <!-- Sign Up Form -->
  <div class="auth-form-container"
       data-form="signup"
       data-auth-tab-target="signupForm">
    <%= form_with model: User.new,
        url: register_path,
        local: false,
        html: { novalidate: true },
        class: "space-y-4",
        data: {
          controller: "form-validation",
          turbo_frame: "auth_result",
          form_validation_translations_value: t('javascript.auth_form').to_json
        } do |form| %>
      <%= render FormFieldComponent.new(
        form: form,
        field: :email_address,
        type: :email,
        required: true,
        placeholder: t('auth.email_placeholder'),
        validation_rules: "email",
        options: { autocomplete: "email" }
      ) %>
      <%= render FormFieldComponent.new(
        form: form,
        field: :password,
        type: :password,
        required: true,
        placeholder: t('auth.password_placeholder'),
        validation_rules: "password",
        options: { autocomplete: "new-password" }
      ) %>
      <%= render FormFieldComponent.new(
        form: form,
        field: :password_confirmation,
        type: :password,
        required: true,
        placeholder: t('auth.password_confirmation_placeholder'),
        validation_rules: "passwordConfirmation",
        options: { autocomplete: "new-password" }
      ) %>
      <%= form.submit t('auth.sign_up'), class: "btn-interactive btn-full btn-lg" %>
    <% end %>
  </div>
</div>
