<div class="header-wrapper"
     data-controller="navigation--header-state navigation--mobile-menu navigation--auth-popup navigation--scroll-detection navigation--header-actions"
     data-navigation--header-state-page-type-value="<%= current_page_type %>"
     <% if current_page_type == 'brand' && @brand&.banner_image&.attached? %>data-navigation--header-state-banner-url-value="<%= Rails.application.routes.url_helpers.url_for(@brand.banner_image) %>"<% end %>
     data-mobile-menu="closed"
     data-auth-popup="closed">
  <header class="site-header" data-navigation--header-state-target="header">
    <!-- Desktop Header -->
    <div class="hidden md:flex items-center justify-between px-4 md:mx-8 md:px-1 py-4">
      <div class="flex items-center space-x-4">
        <!-- Location Selector -->
        <div class="flex items-center space-x-2">
          <%= render UI::IconComponent.new(name: :location, css_class: "w-4 h-4") %>
          <button class="hover:text-interactive transition-colors text-sm"
                  data-action="click->navigation--header#selectLocation">
            <%= t('header.location.beirut') %>
          </button>
        </div>
        <!-- Language Switcher -->
        <div class="flex items-center space-x-2 text-sm">
          <%= language_link(:en, "EN") %>
          <span class="text-disabled">|</span>
          <%= language_link(:ar, "العربية") %>
        </div>
      </div>
      <!-- Logo Icon -->
      <div class="flex justify-center">
        <%= link_to root_path, class: "flex items-center", "aria-label": t('header.logo_alt') do %>
          <div class="w-10 h-10 flex items-center justify-center">
            <%= render UI::IconComponent.new(name: :logo, css_class: "w-6 h-6") %>
          </div>
        <% end %>
      </div>
      <!-- Action Icons -->
      <div class="flex items-center space-x-4">
        <%= render UI::HeaderActionButtonComponent.new(
            icon: 'search',
            action: 'navigation--header-actions#openSearch',
            aria_label: t('header.actions.search')) %>
        <%= render UI::HeaderActionButtonComponent.new(
            icon: 'heart',
            action: 'navigation--header-actions#openFavorites',
            aria_label: t('header.actions.favorites'),
            badge: header_badge_count(:favorites)) %>
        <%= render UI::HeaderActionButtonComponent.new(
            icon: 'user',
            action: 'navigation--auth-popup#openProfile',
            aria_label: t('header.actions.profile')) %>
        <div id="cart-badge" class="relative">
          <%= render UI::HeaderActionButtonComponent.new(
              icon: 'shopping_cart',
              action: 'application#openCart',
              aria_label: t('header.actions.cart'),
              badge: header_badge_count(:cart)) %>
        </div>
      </div>
    </div>
    <!-- Mobile Header -->
    <div class="md:hidden flex items-center justify-between px-4 py-4">
      <!-- Menu Icon -->
      <button class="mobile-menu-toggle"
              data-action="click->navigation--mobile-menu#toggleMenu"
              data-navigation--mobile-menu-target="toggle"
              aria-label="<%= t('header.mobile_menu_toggle') %>"
              aria-expanded="false">
        <%= render UI::IconComponent.new(name: :menu, css_class: "w-5 h-5") %>
      </button>
      <!-- Search Icon -->
      <%= render UI::HeaderActionButtonComponent.new(
          icon: 'search',
          action: 'navigation--header-actions#openSearch',
          aria_label: t('header.actions.search')) %>

      <!-- Logo -->
      <%= link_to root_path, class: "flex items-center", "aria-label": t('header.logo_alt') do %>
        <div class="w-8 h-8 flex items-center justify-center">
          <%= render UI::IconComponent.new(name: :logo, css_class: "w-5 h-5") %>
        </div>
      <% end %>
      <!-- Wishlist Icon -->
      <%= render UI::HeaderActionButtonComponent.new(
          icon: 'heart',
          action: 'navigation--header-actions#openFavorites',
          aria_label: t('header.actions.favorites'),
          badge: header_badge_count(:favorites)) %>
      <!-- Cart Icon -->
      <div id="mobile-cart-badge" class="relative">
        <%= render UI::HeaderActionButtonComponent.new(
            icon: 'shopping_cart',
            action: 'application#openCart',
            aria_label: t('header.actions.cart'),
            badge: header_badge_count(:cart)) %>
      </div>
    </div>
  </header>
  <nav class="navigation-wrapper hidden md:block transition-all duration-300" aria-label="<%= t('header.nav.main_navigation') %>" data-navigation--header-state-target="nav">
    <div class="container mx-auto px-4">
      <%= render Header::NavigationListComponent.new(
          navigation_items: header_navigation_items,
          variant: :desktop) %>
    </div>
  </nav>
  <%= render Header::MobileMenuComponent.new(navigation_items: header_navigation_items) %>
  <%= render AuthPopupComponent.new(current_user: Current.user) %>
</div>
